#!/bin/bash -e

mkdir -p test_repos
rm -rf test_repos/*
cd test_repos

git init master
cd master
cat > shared_config_manager.yaml <<END
sources:
  test_git:
    type: git
    repo: /repos/test_git
    key: changeme
  test_auth_git:
    type: git
    repo: git@github.com:camptocamp/private-geo-charts.git
    key: changeme
    ssh_key: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEpAIBAAKCAQEAqHmkARUeQJEtAJTEUx0AHhUmU2bl3EeWQA0fCbSB6wURTZQE
      P64O3uH+uA662mw0k/GFQl2FzgJN0WUherpQyAqTahk+iqfxkP69g092OJZPqcwd
      8mGxBtGB1iYIFk2VGZIu6mr0ij1n99qm59sVUG2V/q7uY+z2jQBL940MeHZ6PSQ+
      C3eb+3d9+pfweNkndog0Pam/Y8CObof7JkeV1SXnm2++3qQPd3RkFBSbExeOKWq6
      L5wj2v5De5u1VgO5QOn+GFnYUJsZqGsrrG9dG5lREM+H9v+fpuJ1d2CryuXycYSA
      +Nxh8mtXY6QJrHFTF9sYBckRlEGIpW5b93QvHQIDAQABAoIBAEEFOSuFx/gpT1Hz
      GFXvUlVJ2lHD26CJLE6qAbmQJbfba9Mh9gXRmkGgvNqyLKERs7UJOGHlkDdyoi/X
      NPWVpImfs0b2WTHQISXReriL2Vd7g2FHuqMJ2vWDs/U/Fk3tQUbuKRclkh0sF80L
      YPEIl5BDyujRAIYmNP00CR2QHSj8CFfIxNndwAyaKCsG/FT4s1P9dKclOmwPmNSe
      jSPGMSsSjp77GcnBT3nq0ZNkPf+bkp2jLCC+uUVZdwzOpqJIyQqxw3ao8th0HjYf
      JzTrJ042EfPkIlLSonKic1YcRG4IvKS5g55DXWtnDWXW/gqXx5+5Tt4gR1X8RDXb
      OciFwWECgYEA1F0tG53H/Y4JOo/CugnCl1yssv6MYJyruM03pxxj/GI4qhuGx0T3
      6sa1y8iy28Je69SarTaw7bdLHWF+UvbFbpc4FrSKGiXY2g9JoDHwLoJofP3uLaG/
      f5ngYK3qhVwgY3pFDskNGzY62xCT1ikubnv3tZCv0qRf8vkozuytD4UCgYEAyxfQ
      YigGTJeyDG0O2alta+j7xoLbujN9w4+wSAgIkslQwbhJ9nKp5N9xCjfzXBENTqp2
      QZWHQ0GKUK4NRtUaPwIgnCIW1yR74Lz6LfI1dKUPLuxy00N/fg4xgAmazeXg3oPh
      /ey8SB0tgxD/Ql1whJpCZeoe2TG8IjJn6BOJmLkCgYEAo/m+VtCiF9qQrbNLvLLE
      mnNotl1urzrKLcvn6RU27y44asEOdNeARrxgq5Ww5ZdUC+0B8jWEsEkTqwAYtp7t
      G9OP75g/+qi2pMmhJBzrRD5VyA2a14lJgJGke4JOz+Ku76D9qcj8YcKh93z5aigq
      Pg1i28N4v8FEhSx2ojCGALECgYEAvqdtbSfrue1SLQ4YOccuvHWsHg/sW+FIt9Rl
      BUndWob4c9MgQ+YijYQg5xndMFmlp2qotyq7Hy0gvlqWhh85k1rY6BmsXW2XiUN+
      jLFq80Sce01nAeLEhb6nQ25Az/d0YQ9nkOuzWPNjLT5AkrmLDkCOAoSFTxm8ZlHx
      b1EgA6kCgYAjXUPJmG7fEmombN+3IoQoahOnr74R3JuvFJAFtry86EkTUkjctdGF
      5iTh+IcbiNVj/fSjtMg3sEi8UstRw4GSVwMspkY4Z2k5zbZPmRBik7RyXyxzMunc
      23mcb1FD8H5eiDmWXHAG1Zq3OYaydThdHYfVtiX9dtD6VUM7vYLjIQ==
      -----END RSA PRIVATE KEY-----
END
git add shared_config_manager.yaml
git commit -a -m "Initial commit"
cd ..

git init test_git
cd test_git
echo "Hello world" > test
git add test
git commit -a -m "Initial commit"
cd ..
